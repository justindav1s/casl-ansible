---
- hosts: masters[0]
  gather_facts: no
  become: yes
  become_method: sudo
  vars:
    description: "Set registry to use Azure Storage"
  tasks:
  - name: "oc secrets new registry-config config.yaml=registryconfig.yaml  -n default"
    shell: "oc secrets new registry-config config.yaml=registryconfig.yaml -n default"
  - name: "oc volume dc/docker-registry --add --type=secret --secret-name=registry-config -m /etc/docker/registry/ -n default"
    shell: "oc volume dc/docker-registry --add --type=secret --secret-name=registry-config -m /etc/docker/registry/ -n default"
  - name: "oc set env dc/docker-registry REGISTRY_CONFIGURATION_PATH=/etc/docker/registry/config.yaml -n default"
    shell: "oc set env dc/docker-registry REGISTRY_CONFIGURATION_PATH=/etc/docker/registry/config.yaml -n default"

